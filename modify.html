
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>The System - Arguing Predictors</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#system-configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Arguing Predictors" class="md-header__button md-logo" aria-label="Arguing Predictors" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Arguing Predictors
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The System
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Arguing Predictors" class="md-nav__button md-logo" aria-label="Arguing Predictors" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Arguing Predictors
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="installation.html" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="usage.html" class="md-nav__link">
        Start
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
      <a href="modify.html" class="md-nav__link md-nav__link--active">
        The System
      </a>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="pre-trained_models.html" class="md-nav__link">
        Pre-Trained Models
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="consensus.html" class="md-nav__link">
        Consensus
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="individual.html" class="md-nav__link">
        Predictors
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="evaluation.html" class="md-nav__link">
        Evaluation
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <style>
    .formatting {
        text-align: justify;
     }
</style>

<h1 id="system-configuration">System Configuration</h1>
<p><div class="formatting">
The system was designed to be adjusted and modified in multiple ways. First, the "tools" directory contains the individual predictors and supports example predictors based on the Keras python library. This overall framework can be used to add further individual predictor configurations but also offers the liberty to add predictors independent of this format. In the case of diverting from this structure, it is important that the predictor returns a DataFrame containing the future predictions. Lastly, the Keras models already contained within the system can be trained and used as pre-trained models.</p>
<p>Please find in the following examples of the pre-training process in the Pre-trained models section.</p>
<p>The "tools" directory furthermore contains the dataloader which serves to import stock data. Other data can be imported by creating a similar data import solution.</p>
<p>Second, the "consensus" directory contains the algorithms.py file. that build the systems final consensus/prediction value. Further, consensus algorithm solutions can be added here as well. In general, the algorithm will need to take in a DataFrame containing the different predictors forecasts and another list or DataFrame containing actual real values. </p>
<p>Third, the directory "system" contains the activate.py file which brings all of the individual parts together and enables the system to run. Multiple adjustments can be made here to tailor the systems output.</p>
<p>Fourth, the evaluation.py included within the tools directory provides the system with evaluation capabilities. The standard file contains a correlation analysis of the absolute error of all algorithms, MSE metric, MSE Log metric and MAE metric. Moreover, the evaluation.py file includes plotting functionalities. More evaluation metrics can be added if needed. </p>
<p>Fifth, the main.py file serves to run the system from a command line. It trains all models specified in the template live and offers a GUI to display the results.</p>
</div>

<h1 id="activatepy">activate.py</h1>
<p><div class="formatting">
The following section will break down the activate.py file in detail and suggests how possible modifications might be implemented.</p>
</div>

<h2 id="imports">Imports</h2>
<p><div class="formatting">
First, all necessary libraries and other parts of the system are imported.</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">consensus.algorithms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tools.dataloader</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tools.predictorsI</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tools.predictorsII</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tools.predictorsIII</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tools.evaluation</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div>
</div></p>
<h2 id="data-preparation">Data preparation</h2>
<p><div class="formatting">
The following function is used to prepare the data into an input batch and real value batch. This function might need adjustments depending on what format other possible predictors may require. In this version, the function is able to deal with all predictors contained in predictorsI.py, predictorsII.py and predictorsIII.py.
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">data_prep</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">input_batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[(</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)]:</span>
    <span class="sd">&#39;&#39;&#39;Takes in data and splits it into an input batch for the individual predictors to perform a prediction on and the real values observed.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            df (DataFrame): Whole data set to be divided into prediction batch and real values.</span>
<span class="sd">            input_batch_size (int): Length of input batch size.</span>
<span class="sd">            future_horizon (int): How many time steps are predicted into the future.</span>

<span class="sd">        Returns:</span>
<span class="sd">            [(DataFrame, DataFrame)]: Input batch dataframe and real value dataframe.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">input_b</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">input_batch_size</span><span class="p">]</span>
    <span class="n">real_value</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">input_batch_size</span><span class="p">:</span><span class="n">input_batch_size</span> <span class="o">+</span> <span class="n">future_horizon</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">input_b</span><span class="p">,</span> <span class="n">real_value</span>
</code></pre></div>
</div></p>
<h2 id="individual-predictor-live-training-templates">Individual predictor live-training templates</h2>
<p><div class="formatting">
The following configurations are examples of how the system can be used with live model training. In detail, these templates train the models in real time instead of loading a pre-trained model. This variation is also used in the demo version of the system in the main.py file. 
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">individual_predictors_template0</span><span class="p">(</span><span class="n">training_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Handles the individual predictors by training them and feeding them the data to predict the specified future horizon. The following individual predictors are implemented:</span>

<span class="sd">    1. CNN-LSTM</span>
<span class="sd">    2. Bidirectional LSTM</span>
<span class="sd">    3. CNN</span>

<span class="sd">        Parameters:</span>
<span class="sd">            training_df (DataFrame): Data on which the predictors are trained on.</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">            epochs (int): Determines for how many epochs each model is trained. </span>

<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">HybridUnivariatePredictor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">,</span> <span class="n">training_df</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">create_cnnlstm</span><span class="p">()</span>
    <span class="n">one</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">show_performance</span><span class="p">()</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">,</span> <span class="n">training_df</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">create_bilstm</span><span class="p">()</span>
    <span class="n">two</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">show_performance</span><span class="p">()</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">,</span> <span class="n">training_df</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">create_cnn</span><span class="p">()</span>
    <span class="n">three</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">show_performance</span><span class="p">()</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_template1</span><span class="p">(</span><span class="n">training_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Handles the individual predictors by training them and feeding them the data to predict the specified future horizon. The following individual predictors are implemented:</span>

<span class="sd">    1. CNN-LSTM</span>
<span class="sd">    2. Bidirectional LSTM</span>
<span class="sd">    3. CNN</span>
<span class="sd">    4. MLP</span>
<span class="sd">    5. LSTM</span>

<span class="sd">        Parameters:</span>
<span class="sd">            training_df (DataFrame): Data on which the predictors are trained on.</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">            epochs (int): Determines for how many epochs each model is trained. </span>

<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">HybridUnivariatePredictor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">,</span> <span class="n">training_df</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">create_cnnlstm</span><span class="p">()</span>
    <span class="n">one</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">show_performance</span><span class="p">()</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">,</span> <span class="n">training_df</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">create_bilstm</span><span class="p">()</span>
    <span class="n">two</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">show_performance</span><span class="p">()</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">,</span> <span class="n">training_df</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">create_cnn</span><span class="p">()</span>
    <span class="n">three</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">show_performance</span><span class="p">()</span>

    <span class="n">four</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">,</span> <span class="n">training_df</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">create_mlp</span><span class="p">()</span>
    <span class="n">four</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">show_performance</span><span class="p">()</span>

    <span class="n">five</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">,</span> <span class="n">training_df</span><span class="p">)</span>
    <span class="n">five</span><span class="o">.</span><span class="n">create_lstm</span><span class="p">()</span>
    <span class="n">five</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
    <span class="n">five</span><span class="o">.</span><span class="n">show_performance</span><span class="p">()</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_four</span> <span class="o">=</span> <span class="n">four</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_five</span> <span class="o">=</span> <span class="n">five</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">,</span> <span class="n">prediction_four</span><span class="p">,</span> <span class="n">prediction_five</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>
</code></pre></div>
The following template is a special version of the prior two. This template enables the use of the Facebook prophet and Facebook neural prophet python libraries. These models do not require a specific batch input to forecast.
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">individual_predictors_template2</span><span class="p">(</span><span class="n">training_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Handles the individual predictors by training them and feeding them the data to predict the specified future horizon. The following individual predictors are implemented:</span>

<span class="sd">    1. Facebook Prophet</span>
<span class="sd">    2. Facebook Neural Prophet</span>

<span class="sd">        Parameters:</span>
<span class="sd">            training_df (DataFrame): Data on which the predictors are trained on.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">UnivariatePredictorII</span><span class="p">(</span><span class="n">training_df</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">fit_neural_model</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">show_performance_neural</span><span class="p">()</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">UnivariatePredictorII</span><span class="p">(</span><span class="n">training_df</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">fit_prophet_model</span><span class="p">()</span>
    <span class="n">two</span><span class="o">.</span><span class="n">show_performance_prophet</span><span class="p">()</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict_neural</span><span class="p">()</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict_prophet</span><span class="p">()</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>
</code></pre></div></p>
<h2 id="individual-predictor-pre-trained-templates">Individual predictor pre-trained templates</h2>
<p><div class="formatting">
The next templates are configured so that a pre-trained Keras model can be used to forecast. These examples use the pre-trained models saved in the "pretrained" directory. It is important to manually set the model id via the set_model_id() setter function.
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">individual_predictors_pretrained_Ford_5_2</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained Ford stock model (horizon=5) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span> <span class="c1"># manual model ID/name setting, necessary since model is pretrained and loaded from a file</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_BP_30_2</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained BP stock model (horizon=30) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_BP_30&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_BP_30&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_SP500_40_2</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained SP500 index model (horizon=40) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_Ford_5_3</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained Ford stock model (horizon=5) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_BP_30_3</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained BP stock model (horizon=30) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_BP_30&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_BP_30&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_BP_30&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_SP500_40_3</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained SP500 index model (horizon=40) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_Ford_5_4</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained Ford stock model (horizon=5) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">    4. Bidirectional-LSTM</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">four</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;BI-LSTM&#39;</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/BI-LSTM_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_four</span> <span class="o">=</span> <span class="n">four</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">,</span> <span class="n">prediction_four</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_BP_30_4</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained BP stock model (horizon=30) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">    4. Bidirectional-LSTM</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_BP_30&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_BP_30&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_BP_30&#39;</span><span class="p">)</span>

    <span class="n">four</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;BI-LSTM&#39;</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/BI-LSTM_BP_30&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_four</span> <span class="o">=</span> <span class="n">four</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">,</span> <span class="n">prediction_four</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_SP500_40_4</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained SP500 index model (horizon=40) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">    4. Bidirectional-LSTM</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">four</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;BI-LSTM&#39;</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/BI-LSTM_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_four</span> <span class="o">=</span> <span class="n">four</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">,</span> <span class="n">prediction_four</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_Ford_5_5</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained Ford stock model (horizon=5) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">    4. Bidirectional-LSTM</span>
<span class="sd">    5. CNN-LSTM</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">four</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;BI-LSTM&#39;</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/BI-LSTM_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">five</span> <span class="o">=</span> <span class="n">HybridUnivariatePredictor</span><span class="p">(</span><span class="n">sub_seq</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">steps_past</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">steps_future</span> <span class="o">=</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">five</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN-LSTM&#39;</span><span class="p">)</span>
    <span class="n">five</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN-LSTM_Ford_5&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_four</span> <span class="o">=</span> <span class="n">four</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_five</span> <span class="o">=</span> <span class="n">five</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">,</span> <span class="n">prediction_four</span><span class="p">,</span> <span class="n">prediction_five</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_BP_30_5</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained BP stock model (horizon=30) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">    4. Bidirectional-LSTM</span>
<span class="sd">    5. CNN-LSTM</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_BP_30&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_BP_30&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_BP_30&#39;</span><span class="p">)</span>

    <span class="n">four</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;BI-LSTM&#39;</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/BI-LSTM_BP_30&#39;</span><span class="p">)</span>

    <span class="n">five</span> <span class="o">=</span> <span class="n">HybridUnivariatePredictor</span><span class="p">(</span><span class="n">sub_seq</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">steps_past</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">steps_future</span> <span class="o">=</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">five</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN-LSTM&#39;</span><span class="p">)</span>
    <span class="n">five</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN-LSTM_BP_30&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_four</span> <span class="o">=</span> <span class="n">four</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_five</span> <span class="o">=</span> <span class="n">five</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">,</span> <span class="n">prediction_four</span><span class="p">,</span> <span class="n">prediction_five</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>

<span class="k">def</span> <span class="nf">individual_predictors_pretrained_SP500_40_5</span><span class="p">(</span><span class="n">input_batch</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">future_horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Loads pretrained SP500 index model (horizon=40) and predicts based on the given input batch. The following individual predictors are implemented:</span>
<span class="sd">    1. LSTM</span>
<span class="sd">    2. CNN</span>
<span class="sd">    3. MLP</span>
<span class="sd">    4. Bidirectional-LSTM</span>
<span class="sd">    5. CNN-LSTM</span>
<span class="sd">        Parameters:</span>
<span class="sd">            input_batch (DataFrame): Data which is fed to predictors to predict future values.</span>
<span class="sd">            future_horizon (int): Length of how far into the future the predictors will predict.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all predictions from all individual predictors.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">one</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;LSTM&#39;</span><span class="p">)</span>
    <span class="n">one</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/LSTM_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">two</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>
    <span class="n">two</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">three</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;MLP&#39;</span><span class="p">)</span>
    <span class="n">three</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/MLP_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">four</span> <span class="o">=</span> <span class="n">BasicUnivariatePredictor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;BI-LSTM&#39;</span><span class="p">)</span>
    <span class="n">four</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/BI-LSTM_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">five</span> <span class="o">=</span> <span class="n">HybridUnivariatePredictor</span><span class="p">(</span><span class="n">sub_seq</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">steps_past</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_batch</span><span class="p">),</span> <span class="n">steps_future</span> <span class="o">=</span> <span class="n">future_horizon</span><span class="p">)</span>
    <span class="n">five</span><span class="o">.</span><span class="n">set_model_id</span><span class="p">(</span><span class="s1">&#39;CNN-LSTM&#39;</span><span class="p">)</span>
    <span class="n">five</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;../pretrained/CNN-LSTM_SP500_40&#39;</span><span class="p">)</span>

    <span class="n">prediction_one</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_two</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_three</span> <span class="o">=</span> <span class="n">three</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_four</span> <span class="o">=</span> <span class="n">four</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
    <span class="n">prediction_five</span> <span class="o">=</span> <span class="n">five</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prediction_one</span><span class="p">,</span> <span class="n">prediction_two</span><span class="p">,</span> <span class="n">prediction_three</span><span class="p">,</span> <span class="n">prediction_four</span><span class="p">,</span> <span class="n">prediction_five</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">final_df</span>
</code></pre></div>
</div></p>
<h2 id="system-disagreement">System disagreement</h2>
<p><div class="formatting">
This function wraps around the system disagreement functions contained in the algorithms.py and plots the results.
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">system_disagreement</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Plots the overall system disagreement and the individual disagreement scores of the algorithms.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            df (DataFrame): Containing all individual predictors forecasts.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">disagreement</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">predictor_score</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
</div></p>
<h2 id="system-consensus-value">System consensus value</h2>
<p><div class="formatting">
This function wraps around the consensus value creation functions contained in the algorithms.py.
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">consensus</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">real</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Applies the following consensus algorithm to provide the final system forecast:</span>

<span class="sd">    1. Average</span>
<span class="sd">    2. No Memory</span>
<span class="sd">    3. Memory</span>
<span class="sd">    4. Focus</span>
<span class="sd">    5. Anchor</span>
<span class="sd">    6. Correcting</span>
<span class="sd">    7. Correcting Memory</span>

<span class="sd">        Parameters:</span>
<span class="sd">            df (DataFrame): Forecasts of all individual predictors.</span>
<span class="sd">            real (DataFrame): The true/actual values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all final consensus values from all algorithms.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">consensus</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span> <span class="c1"># DataFrame that will hold all consensus values</span>

    <span class="n">average</span> <span class="o">=</span> <span class="n">average_consolidation</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">nomemory</span> <span class="o">=</span> <span class="n">consolidated_predictions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="n">consolidated_predictions_memory</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span>
    <span class="n">focus</span> <span class="o">=</span> <span class="n">consolidated_predictions_focused</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span>
    <span class="n">anchor</span> <span class="o">=</span> <span class="n">consolidated_predictions_anchor</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">real</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
    <span class="n">correcting</span> <span class="o">=</span> <span class="n">consolidated_predictions_correcting</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span>
    <span class="n">correcting_mem</span> <span class="o">=</span> <span class="n">consolidated_predictions_memory_correcting</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span>

    <span class="n">consensus</span><span class="p">[</span><span class="s1">&#39;Average&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">average</span>
    <span class="n">consensus</span><span class="p">[</span><span class="s1">&#39;NoMemory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nomemory</span>
    <span class="n">consensus</span><span class="p">[</span><span class="s1">&#39;Memory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span>
    <span class="n">consensus</span><span class="p">[</span><span class="s1">&#39;Focus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">focus</span>
    <span class="n">consensus</span><span class="p">[</span><span class="s1">&#39;Anchor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">anchor</span>
    <span class="n">consensus</span><span class="p">[</span><span class="s1">&#39;Correcting&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">correcting</span>
    <span class="n">consensus</span><span class="p">[</span><span class="s1">&#39;Correcting Memory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">correcting_mem</span>

    <span class="k">return</span> <span class="n">consensus</span>
</code></pre></div>
</div></p>
<h2 id="correcting-consensus-algorithm-only">Correcting consensus algorithm only</h2>
<p><div class="formatting">
This is an alternative version of the prior consensus function that allows to only apply the correcting consensus value algorithm.
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">consensus_optimal</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">real</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Applies the correcting consensus algorithm to provide the final system forecast.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            df (DataFrame): Forecasts of all individual predictors.</span>
<span class="sd">            real (DataFrame): The true/actual values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (DataFrame): Containing all final consensus values from all algorithms.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">consensus</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span> <span class="c1"># DataFrame that will hold consensus values</span>

    <span class="n">correcting</span> <span class="o">=</span> <span class="n">consolidated_predictions_correcting</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span>    
    <span class="n">consensus</span><span class="p">[</span><span class="s1">&#39;Correcting&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">correcting</span>

    <span class="k">return</span> <span class="n">consensus</span>
</code></pre></div>
</div></p>
<h1 id="mainpy">main.py</h1>
<p><div class="formatting">
This file contains the logic of running the system from a command line. Multiple adjustments can be made to further tailor the system.
</div></p>
<h2 id="importing-the-system">Importing the system</h2>
<p><div class="formatting">
This part of the code imports the python library PySimpleGUI to generate the GUI after the models have completed the training cycle. Moreover, it imports the proof-of-concept system.
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">PySimpleGUI</span> <span class="k">as</span> <span class="nn">sg</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">tools.dataloader</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">system.activate</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div>
</div></p>
<h2 id="system-activation-live-training">System activation - Live training</h2>
<p><div class="formatting">
The next part initiates the live training process of the models defined and applies all other functions to generate the consensus value and evaluation metrics. This code should be modified to change the stock, trainings data, prediction horizon data, evaluation function, individual prediction models and consensus algorithms used. It is recommended to set-up other prediction and consensus algorithms and any other new functions within the activate.py file.
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Example main function to execute the system without a jupyter notebook as UI.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">predict</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="s1">&#39;BP&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-02-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-05-01&#39;</span><span class="p">)</span> <span class="c1"># loading DataFrame of time-frame to be predicted</span>
    <span class="n">predict</span> <span class="o">=</span> <span class="n">predict</span><span class="o">.</span><span class="n">get_adjclose</span><span class="p">()</span>

    <span class="n">training</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="s1">&#39;BP&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-01&#39;</span><span class="p">)</span> <span class="c1"># loading training DataFrame to train model on</span>
    <span class="n">training</span> <span class="o">=</span> <span class="n">training</span><span class="o">.</span><span class="n">get_adjclose</span><span class="p">()</span>

    <span class="n">predict_req</span><span class="p">,</span> <span class="n">real</span> <span class="o">=</span> <span class="n">data_prep</span><span class="p">(</span><span class="n">predict</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="c1"># dividing data into predictor input and real data</span>
    <span class="n">individual_predictors_forecasts</span> <span class="o">=</span> <span class="n">individual_predictors_template1</span><span class="p">(</span><span class="n">training</span><span class="p">,</span> <span class="n">predict_req</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># make forecast</span>
    <span class="n">consensus_forecasts</span> <span class="o">=</span> <span class="n">consensus</span><span class="p">(</span><span class="n">individual_predictors_forecasts</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span> <span class="c1"># create consolidation values</span>
    <span class="c1">#consensus_forecasts = consensus_optimal(individual_predictors_forecasts, real) # create consolidation value only with correcting algorithm</span>
    <span class="n">all_forecasts</span> <span class="o">=</span> <span class="n">combined_frame</span><span class="p">(</span><span class="n">individual_predictors_forecasts</span><span class="p">,</span> <span class="n">consensus_forecasts</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span> 
    <span class="n">prediction_error</span> <span class="o">=</span> <span class="n">absolute_error_analytics</span><span class="p">(</span><span class="n">individual_predictors_forecasts</span><span class="p">,</span> <span class="n">consensus_forecasts</span><span class="p">,</span> <span class="n">real</span><span class="p">)</span> <span class="c1"># create absolute error DataFrame</span>
</code></pre></div>
The next part defines the GUI pop-up window layout:
<div class="highlight"><pre><span></span><code>    <span class="c1"># build GUI for data visualization</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">ChangeLookAndFeel</span><span class="p">(</span><span class="s1">&#39;Dark&#39;</span><span class="p">)</span>      
    <span class="n">sg</span><span class="o">.</span><span class="n">SetOptions</span><span class="p">(</span><span class="n">element_padding</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">layout</span> <span class="o">=</span> <span class="p">[</span>

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Arguing Predictors&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Consolas&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))],</span>

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;&#39;</span>  <span class="o">*</span> <span class="mi">50</span><span class="p">)],</span>      

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="s1">&#39;Overall System&#39;</span><span class="p">,[[</span> 
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;System Disagreement&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)),</span>
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">))]])],</span> 

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;&#39;</span>  <span class="o">*</span> <span class="mi">70</span><span class="p">)],</span>      

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="s1">&#39;Evaluation metrics&#39;</span><span class="p">,[[</span> 
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)),</span> 
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;MSE Log&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)),</span> 
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;MAE&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">))]])],</span>

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;&#39;</span>  <span class="o">*</span> <span class="mi">70</span><span class="p">)],</span>      

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="s1">&#39;Save to CSV&#39;</span><span class="p">,[[</span> 
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;All Forecasts&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)),</span>
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;MSE values&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)),</span>
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;MSE Log values&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)),</span>
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;MAE values&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">))]])],</span> 

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;&#39;</span>  <span class="o">*</span> <span class="mi">70</span><span class="p">)],</span>      

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="s1">&#39;Summary&#39;</span><span class="p">,[[</span> 
              <span class="n">sg</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Plot Performance&#39;</span><span class="p">,</span> <span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">))]])],</span>

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;_&#39;</span>  <span class="o">*</span> <span class="mi">70</span><span class="p">)],</span>      

              <span class="p">[</span><span class="n">sg</span><span class="o">.</span><span class="n">Cancel</span><span class="p">(</span><span class="n">button_color</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">))]]</span>

    <span class="n">window</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span><span class="s1">&#39;Arguing Predictors&#39;</span><span class="p">,</span> <span class="n">layout</span><span class="p">,</span> <span class="n">default_element_size</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></p>
<p>The code in the above generates with help of the PySimpleGUI library the following simple GUI window:</p>
</div>

<p><img alt="Gui window" src="resources/gui.png" /></p>
<p>Finally, the while loop in the below adds functionality to the buttons created in the prior part:
<div class="highlight"><pre><span></span><code>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">event</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">event</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">WIN_CLOSED</span><span class="p">,</span> <span class="s1">&#39;Cancel&#39;</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;System Disagreement&#39;</span><span class="p">:</span>            
            <span class="n">system_disagreement</span><span class="p">(</span><span class="n">individual_predictors_forecasts</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;Correlation&#39;</span><span class="p">:</span>
            <span class="n">correlation</span><span class="p">(</span><span class="n">prediction_error</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span>
            <span class="n">mse_score</span><span class="p">(</span><span class="n">all_forecasts</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;MSE Log&#39;</span><span class="p">:</span>
            <span class="n">mse_log_score</span><span class="p">(</span><span class="n">all_forecasts</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;MAE&#39;</span><span class="p">:</span>
            <span class="n">mae_score</span><span class="p">(</span><span class="n">all_forecasts</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;All Forecasts&#39;</span><span class="p">:</span>
            <span class="n">all_forecasts</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;All_Forecasts.csv&#39;</span><span class="p">)</span> <span class="c1"># the following four buttons save the target data in csv format into the same directory where the main.py file has been executed</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;MSE values&#39;</span><span class="p">:</span>
            <span class="n">mse_score</span><span class="p">(</span><span class="n">all_forecasts</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MSE.csv&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;MSE Log values&#39;</span><span class="p">:</span>
            <span class="n">mse_log_score</span><span class="p">(</span><span class="n">all_forecasts</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MSE_Log.csv&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;MAE values&#39;</span><span class="p">:</span>
            <span class="n">mae_score</span><span class="p">(</span><span class="n">all_forecasts</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;MAE.csv&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;Plot Performance&#39;</span><span class="p">:</span>
            <span class="n">plot_performance</span><span class="p">(</span><span class="n">all_forecasts</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">window</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="usage.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Start
            </div>
          </div>
        </a>
      
      
        <a href="pre-trained_models.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Pre-Trained Models
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>